<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="FinanceTracker.AddPaymentPage"
             BackgroundColor="Ivory"
             Title="AddPaymentPage">
    <VerticalStackLayout>
        <Label x:Name="BillNameLabel"
               FontSize="30"
                FontAttributes="Bold"
                Text=""
                VerticalOptions="Center" 
                HorizontalOptions="Center" />
        <Label x:Name="CurrentBalanceLabel" FontSize="20" 
               FontAttributes="Bold" VerticalOptions="Center" HorizontalOptions="Center"></Label>
        <!--<Grid ColumnDefinitions="170,*" ColumnSpacing="12">
            <Label Text="Bill Name:" Padding="20,0,20,0" VerticalOptions="Center"></Label>
            --><!--<Entry x:Name="NameEntry" Margin="0,0,20,0"  Grid.Column="1"></Entry>--><!--
        </Grid>-->
        <!--Grid ColumnDefinitions="Auto,*" ColumnSpacing="12">-->
            <!--<Label x:Name="CurrentBalanceLabel" Padding="20,0,20,0" FontSize="20" FontAttributes="Bold" VerticalOptions="Center"></Label>-->
            <!--<Entry x:Name="BalanceEntry" Keyboard="Numeric" Margin="0,0,20,0" Grid.Column="1"></Entry>-->
        <!--</Grid>-->
        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="12" RowDefinitions="Auto,Auto">
            <Label Text="Payment Amount:" FontSize="18" Padding="20,0,20,0" Grid.Row="0" VerticalOptions="Center"></Label>
            <Entry x:Name="PaymentAmountEntry" Placeholder="Enter Amount" PlaceholderColor="DarkGrey" 
                   Keyboard="Numeric" Margin="0,0,20,0" Grid.Row="0" Grid.Column="1"></Entry>

            <Label Text="Payment Date: " FontSize="18" Padding="20,0,20,0" VerticalOptions="Center" Grid.Row="1"></Label>
            <DatePicker x:Name="PaymentDatePicker" Margin="0,0,20,0" Grid.Row="1" Grid.Column="1"></DatePicker>
        </Grid>

        <Grid ColumnDefinitions="*,Auto" Margin="0,0,20,0">
            <HorizontalStackLayout Grid.Column="1" HorizontalOptions="End" Spacing="10">
                <Button Text="Save" FontSize="15" FontAttributes="Bold" BackgroundColor="LightGreen" TextColor="Black" BorderColor="Black" 
                    BorderWidth="2" HorizontalOptions="Center" Margin="15" WidthRequest="85" Clicked="OnSavePaymentClicked">
                    <Button.Shadow>
                        <Shadow Brush="Gray" Opacity="0.8" Radius="10" Offset="5,5"></Shadow>
                    </Button.Shadow>
                </Button>
                <Button Text="Cancel" FontSize="15" BackgroundColor="SteelBlue" TextColor="Black" BorderColor="Black"
                    BorderWidth="2" HorizontalOptions="Center" Margin="15"  Clicked="OnCancelClicked">
                    <Button.Shadow>
                        <Shadow Brush="Gray" Opacity="0.8" Radius="10" Offset="5,5"></Shadow>
                    </Button.Shadow>
                </Button>
            </HorizontalStackLayout>
        </Grid>

        <Label Text="Payment History:" FontSize="20" FontAttributes="Bold" VerticalOptions="Center" HorizontalOptions="Center"></Label>

        <!--<Grid ColumnDefinitions="Auto,*" ColumnSpacing="12" RowDefinitions="Auto,Auto">
            <Label Text="Payment Date" FontSize="16" Padding="20,0,20,0"></Label>
        </Grid>-->

            <!-- Header Row -->
            <!--<Grid ColumnDefinitions="2*,2*,2*"  Padding="10">
                <Label Text="Date" FontAttributes="Bold"/>
                <Label Text="Amount" FontAttributes="Bold" HorizontalOptions="Center"/>
                <Label Text="Balance" FontAttributes="Bold" HorizontalOptions="End"/>
            </Grid>-->
        <Frame HeightRequest="700" Padding="0" HasShadow="False" Margin="0,0,0,10">
            <!-- Payment History List -->
        <CollectionView x:Name="PaymentsCollectionView" ItemsSource="{Binding Payments}" Margin="0,0,0,10">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <!-- Row Box -->
                    <Frame BorderColor="Black" BackgroundColor="LightBlue" HasShadow="False" CornerRadius="0" Padding="10" Margin="0,5">
                        <Grid ColumnDefinitions="*,2*,2*,Auto" BackgroundColor="LightBlue" Padding="15">

                            <HorizontalStackLayout Grid.Column="0" HorizontalOptions="Center">
                                <Label Text="Date:" FontAttributes="Bold" VerticalOptions="Center"/>
                                <Label Text="{Binding PaymentDate, StringFormat='{0:MM/dd/yyyy}'}"
                                       Margin="10,0,0,0" VerticalOptions="Center"/>
                            </HorizontalStackLayout>

                            <HorizontalStackLayout Grid.Column="1" HorizontalOptions="Center">
                                <Label Text="Amount:" FontAttributes="Bold" VerticalOptions="Center" HorizontalOptions="Center"/>
                                <Label Text="{Binding Amount, StringFormat='${0:F2}'}"
                                       Margin="10,0,0,0" HorizontalOptions="Center" VerticalOptions="Center"/>
                            </HorizontalStackLayout>

                            <HorizontalStackLayout Grid.Column="2" HorizontalOptions="Center">
                                <Label Text="Balance After Payment:" FontAttributes="Bold" VerticalOptions="Center" HorizontalOptions="End"/>
                                <Label Text="{Binding BalanceAfterPayment, StringFormat='${0:F2}'}"
                                       Margin="10,0,0,0" HorizontalOptions="End" VerticalOptions="Center"/>
                            </HorizontalStackLayout>

                            <HorizontalStackLayout Grid.Column="3" HorizontalOptions="End">
                                <Button Text="Edit" Grid.Column="3" BackgroundColor="LightCoral" TextColor="Black" BorderColor="Black" 
                                        BorderWidth="2" HorizontalOptions="End" VerticalOptions="Center" Margin="5,0,0,0" Clicked="OnEditPaymentClicked" BindingContext="{Binding .}" >
                                    <Button.Shadow>
                                        <Shadow Brush="Gray" Opacity="0.8" Radius="10" Offset="5,5"></Shadow>
                                    </Button.Shadow>
                                </Button>
                            </HorizontalStackLayout>
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
        </Frame>
    </VerticalStackLayout>
</ContentPage>